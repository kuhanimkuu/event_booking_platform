{% extends 'base.html' %}
{% block title %}All Events{% endblock %}
{% block content %}

<section class="py-12">
  <div class="max-w-6xl mx-auto px-4">
    <form method="get" class="mb-8 flex gap-2">
      <input type="text" name="q" value="{{ search }}" placeholder="Search events..." class="flex-1 border rounded px-3 py-2 shadow-sm" />
      <button type="submit" class="bg-pink-600 text-white px-4 py-2 rounded">Search</button>
    </form>

    {% if event_data %}
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for item in event_data %}
          {% with event=item.event %}
          <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold text-gray-800 mb-2">{{ event.title }}</h2>

            {% if item.status == "Ended" %}
              <p class="text-red-600 font-semibold mb-2">This event has ended.</p>
              <ul class="text-sm text-gray-700 space-y-1">
                <li><strong>Start:</strong> {{ event.start_time|date:"F j, Y @ g:i A" }}</li>
                <li><strong>End:</strong> {{ event.end_time|date:"F j, Y @ g:i A" }}</li>
                <li><strong>Venue:</strong> {{ event.venue.name }}</li>
                <li><strong>Tickets Sold:</strong> {{ item.total_booked }}</li>
                <li><strong>Remaining:</strong> {{ item.remaining }}</li>
              </ul>
            {% else %}
              <p class="text-sm text-gray-600 mb-2">
                <strong>Date:</strong> {{ event.date|date:"F j, Y @ g:i A" }}<br>
                <strong>Venue:</strong> {{ event.venue.name }}
              </p>
              <a href="{% url 'event-detail' event.pk %}" class="mt-2 inline-block bg-pink-600 text-white px-4 py-2 rounded hover:bg-pink-700 transition">
                View Details
              </a>
            {% endif %}
          </div>
          {% endwith %}
        {% endfor %}
      </div>
    {% else %}
      <div class="bg-yellow-50 border border-yellow-300 text-yellow-800 px-4 py-3 rounded">
        <p>No events found for "{{ search }}".</p>
      </div>
    {% endif %}
  </div>
</section>

{% endblock %}
